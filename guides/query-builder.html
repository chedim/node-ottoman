<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Query Builder | Ottoman.js</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Ottoman is an ODM built for Couchbase and Node.js. ">
    
    <link rel="preload" href="/assets/css/0.styles.53ef105f.css" as="style"><link rel="preload" href="/assets/js/app.42729f85.js" as="script"><link rel="preload" href="/assets/js/2.a7ba359b.js" as="script"><link rel="preload" href="/assets/js/65.0ce04018.js" as="script"><link rel="prefetch" href="/assets/js/10.0f9eeaa0.js"><link rel="prefetch" href="/assets/js/100.db8a3075.js"><link rel="prefetch" href="/assets/js/101.15d64409.js"><link rel="prefetch" href="/assets/js/11.28d6e925.js"><link rel="prefetch" href="/assets/js/12.3acb8133.js"><link rel="prefetch" href="/assets/js/13.2422caf6.js"><link rel="prefetch" href="/assets/js/14.3c899202.js"><link rel="prefetch" href="/assets/js/15.f812e4cf.js"><link rel="prefetch" href="/assets/js/16.bcf9c8c3.js"><link rel="prefetch" href="/assets/js/17.e7e099ae.js"><link rel="prefetch" href="/assets/js/18.560a4832.js"><link rel="prefetch" href="/assets/js/19.e6b063a7.js"><link rel="prefetch" href="/assets/js/20.8b80702c.js"><link rel="prefetch" href="/assets/js/21.4c8f5db1.js"><link rel="prefetch" href="/assets/js/22.fe97cfa0.js"><link rel="prefetch" href="/assets/js/23.cbe75c75.js"><link rel="prefetch" href="/assets/js/24.189c215b.js"><link rel="prefetch" href="/assets/js/25.ac80d425.js"><link rel="prefetch" href="/assets/js/26.a630c2fe.js"><link rel="prefetch" href="/assets/js/27.708957a2.js"><link rel="prefetch" href="/assets/js/28.40521f2d.js"><link rel="prefetch" href="/assets/js/29.a2ac1984.js"><link rel="prefetch" href="/assets/js/3.8c47ec01.js"><link rel="prefetch" href="/assets/js/30.c8d479d2.js"><link rel="prefetch" href="/assets/js/31.f01458ea.js"><link rel="prefetch" href="/assets/js/32.15babd24.js"><link rel="prefetch" href="/assets/js/33.c116e117.js"><link rel="prefetch" href="/assets/js/34.57329b1e.js"><link rel="prefetch" href="/assets/js/35.4d98fa28.js"><link rel="prefetch" href="/assets/js/36.05bcd7b5.js"><link rel="prefetch" href="/assets/js/37.f2345407.js"><link rel="prefetch" href="/assets/js/38.413bd239.js"><link rel="prefetch" href="/assets/js/39.d7343a6d.js"><link rel="prefetch" href="/assets/js/4.30bb1536.js"><link rel="prefetch" href="/assets/js/40.bab617f3.js"><link rel="prefetch" href="/assets/js/41.c1a6fad4.js"><link rel="prefetch" href="/assets/js/42.2903d468.js"><link rel="prefetch" href="/assets/js/43.f7ca82b2.js"><link rel="prefetch" href="/assets/js/44.e2aee6f0.js"><link rel="prefetch" href="/assets/js/45.e14d3a2e.js"><link rel="prefetch" href="/assets/js/46.04d94274.js"><link rel="prefetch" href="/assets/js/47.fd28cc21.js"><link rel="prefetch" href="/assets/js/48.415e51b9.js"><link rel="prefetch" href="/assets/js/49.ab98bdde.js"><link rel="prefetch" href="/assets/js/5.7297f90e.js"><link rel="prefetch" href="/assets/js/50.1db940e7.js"><link rel="prefetch" href="/assets/js/51.873c9854.js"><link rel="prefetch" href="/assets/js/52.b718e278.js"><link rel="prefetch" href="/assets/js/53.3bf3ab65.js"><link rel="prefetch" href="/assets/js/54.bfdb8a85.js"><link rel="prefetch" href="/assets/js/55.181ab84c.js"><link rel="prefetch" href="/assets/js/56.dbeadf8c.js"><link rel="prefetch" href="/assets/js/57.8a3912f9.js"><link rel="prefetch" href="/assets/js/58.8ccb8cad.js"><link rel="prefetch" href="/assets/js/59.1af6336c.js"><link rel="prefetch" href="/assets/js/6.4a93deda.js"><link rel="prefetch" href="/assets/js/60.889ee060.js"><link rel="prefetch" href="/assets/js/61.2bb4d046.js"><link rel="prefetch" href="/assets/js/62.eae9a63f.js"><link rel="prefetch" href="/assets/js/63.4180f885.js"><link rel="prefetch" href="/assets/js/64.0f32f7f6.js"><link rel="prefetch" href="/assets/js/66.51b36df2.js"><link rel="prefetch" href="/assets/js/67.1824c9d2.js"><link rel="prefetch" href="/assets/js/68.0f4e0f19.js"><link rel="prefetch" href="/assets/js/69.cb970ca5.js"><link rel="prefetch" href="/assets/js/7.24de34ca.js"><link rel="prefetch" href="/assets/js/70.0caca796.js"><link rel="prefetch" href="/assets/js/71.0dacf534.js"><link rel="prefetch" href="/assets/js/72.03372ae1.js"><link rel="prefetch" href="/assets/js/73.26742510.js"><link rel="prefetch" href="/assets/js/74.c2b4aaf7.js"><link rel="prefetch" href="/assets/js/75.7f9eb7ea.js"><link rel="prefetch" href="/assets/js/76.9368c948.js"><link rel="prefetch" href="/assets/js/77.a1df543c.js"><link rel="prefetch" href="/assets/js/78.9d815e81.js"><link rel="prefetch" href="/assets/js/79.c1402b2a.js"><link rel="prefetch" href="/assets/js/8.fee6bc16.js"><link rel="prefetch" href="/assets/js/80.53464686.js"><link rel="prefetch" href="/assets/js/81.23fb2b48.js"><link rel="prefetch" href="/assets/js/82.89dbf5e6.js"><link rel="prefetch" href="/assets/js/83.a5836ffb.js"><link rel="prefetch" href="/assets/js/84.e138bd01.js"><link rel="prefetch" href="/assets/js/85.0f54a473.js"><link rel="prefetch" href="/assets/js/86.1414d0ec.js"><link rel="prefetch" href="/assets/js/87.69a2b20c.js"><link rel="prefetch" href="/assets/js/88.70511373.js"><link rel="prefetch" href="/assets/js/89.28fb28ee.js"><link rel="prefetch" href="/assets/js/9.35aae986.js"><link rel="prefetch" href="/assets/js/90.3364af6c.js"><link rel="prefetch" href="/assets/js/91.863c17fe.js"><link rel="prefetch" href="/assets/js/92.d315668f.js"><link rel="prefetch" href="/assets/js/93.2bf2c237.js"><link rel="prefetch" href="/assets/js/94.ebdb13da.js"><link rel="prefetch" href="/assets/js/95.fe6756c7.js"><link rel="prefetch" href="/assets/js/96.996825ae.js"><link rel="prefetch" href="/assets/js/97.0bb664e6.js"><link rel="prefetch" href="/assets/js/98.cb199f62.js"><link rel="prefetch" href="/assets/js/99.3af936d7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.53ef105f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Ottoman.js</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guides/quick-start.html" class="nav-link">
  Quick Start
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Basic" class="dropdown-title"><span class="title">Basic</span> <span class="arrow down"></span></button> <button type="button" aria-label="Basic" class="mobile-dropdown-title"><span class="title">Basic</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guides/ottoman.html" class="nav-link">
  Ottoman
</a></li><li class="dropdown-item"><!----> <a href="/guides/schema.html" class="nav-link">
  Schema
</a></li><li class="dropdown-item"><!----> <a href="/guides/model.html" class="nav-link">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/guides/document.html" class="nav-link">
  Document
</a></li><li class="dropdown-item"><!----> <a href="/guides/query-builder.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Query Builder
</a></li><li class="dropdown-item"><!----> <a href="/guides/mongoose-to-couchbase.html" class="nav-link">
  Mongoose to Ottoman
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Advanced" class="dropdown-title"><span class="title">Advanced</span> <span class="arrow down"></span></button> <button type="button" aria-label="Advanced" class="mobile-dropdown-title"><span class="title">Advanced</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advanced/how-ottoman-works.html" class="nav-link">
  How Ottoman Works
</a></li><li class="dropdown-item"><!----> <a href="/advanced/ottoman.html" class="nav-link">
  Ottoman
</a></li></ul></div></div><div class="nav-item"><a href="/guides/first-app.html" class="nav-link">
  Example
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="API" class="dropdown-title"><span class="title">API</span> <span class="arrow down"></span></button> <button type="button" aria-label="API" class="mobile-dropdown-title"><span class="title">API</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/classes/ottoman.html" class="nav-link">
  Ottoman
</a></li><li class="dropdown-item"><!----> <a href="/classes/schema.html" class="nav-link">
  Schema
</a></li><li class="dropdown-item"><!----> <a href="/classes/model.html" class="nav-link">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/classes/document.html" class="nav-link">
  Document
</a></li><li class="dropdown-item"><!----> <a href="/classes/query.html" class="nav-link">
  Query Builder
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/couchbaselabs/node-ottoman" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guides/quick-start.html" class="nav-link">
  Quick Start
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Basic" class="dropdown-title"><span class="title">Basic</span> <span class="arrow down"></span></button> <button type="button" aria-label="Basic" class="mobile-dropdown-title"><span class="title">Basic</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guides/ottoman.html" class="nav-link">
  Ottoman
</a></li><li class="dropdown-item"><!----> <a href="/guides/schema.html" class="nav-link">
  Schema
</a></li><li class="dropdown-item"><!----> <a href="/guides/model.html" class="nav-link">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/guides/document.html" class="nav-link">
  Document
</a></li><li class="dropdown-item"><!----> <a href="/guides/query-builder.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Query Builder
</a></li><li class="dropdown-item"><!----> <a href="/guides/mongoose-to-couchbase.html" class="nav-link">
  Mongoose to Ottoman
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Advanced" class="dropdown-title"><span class="title">Advanced</span> <span class="arrow down"></span></button> <button type="button" aria-label="Advanced" class="mobile-dropdown-title"><span class="title">Advanced</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advanced/how-ottoman-works.html" class="nav-link">
  How Ottoman Works
</a></li><li class="dropdown-item"><!----> <a href="/advanced/ottoman.html" class="nav-link">
  Ottoman
</a></li></ul></div></div><div class="nav-item"><a href="/guides/first-app.html" class="nav-link">
  Example
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="API" class="dropdown-title"><span class="title">API</span> <span class="arrow down"></span></button> <button type="button" aria-label="API" class="mobile-dropdown-title"><span class="title">API</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/classes/ottoman.html" class="nav-link">
  Ottoman
</a></li><li class="dropdown-item"><!----> <a href="/classes/schema.html" class="nav-link">
  Schema
</a></li><li class="dropdown-item"><!----> <a href="/classes/model.html" class="nav-link">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/classes/document.html" class="nav-link">
  Document
</a></li><li class="dropdown-item"><!----> <a href="/classes/query.html" class="nav-link">
  Query Builder
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/couchbaselabs/node-ottoman" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Query Builder</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guides/query-builder.html#using-the-query-builder" class="sidebar-link">Using the Query Builder</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guides/query-builder.html#build-a-query-by-using-parameters" class="sidebar-link">Build a Query by Using Parameters</a></li><li class="sidebar-sub-header"><a href="/guides/query-builder.html#build-a-query-by-using-access-functions" class="sidebar-link">Build a Query by Using Access Functions</a></li><li class="sidebar-sub-header"><a href="/guides/query-builder.html#build-a-query-by-using-parameters-and-function-parameters" class="sidebar-link">Build a Query by Using Parameters and Function Parameters</a></li><li class="sidebar-sub-header"><a href="/guides/query-builder.html#advanced-example-of-using-the-where-clause" class="sidebar-link">Advanced Example of Using the WHERE Clause</a></li></ul></li><li><a href="/guides/query-builder.html#n1ql-select-clause-structure" class="sidebar-link">N1QL SELECT Clause Structure</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guides/query-builder.html#n1ql-select-nested-clause-example" class="sidebar-link">N1QL SELECT Nested Clause Example</a></li></ul></li><li><a href="/guides/query-builder.html#n1ql-where-clause-structure" class="sidebar-link">N1QL WHERE Clause Structure</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/guides/query-builder.html#n1ql-join-clause-structure" class="sidebar-link">N1QL JOIN Clause Structure</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/guides/query-builder.html#n1ql-group-by-clause-structure" class="sidebar-link">N1QL GROUP BY Clause Structure</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="query-builder"><a href="#query-builder" class="header-anchor">#</a> Query Builder</h1> <p><a href="/classes/query.html">Query Builder</a> is a flexible tool designed to create N1QL queries by specifying parameters and methods. Query Builder lets you: create queries of unlimited length and complexity without the need to know the syntax of N1QL Queries.</p> <h2 id="using-the-query-builder"><a href="#using-the-query-builder" class="header-anchor">#</a> Using the Query Builder</h2> <p>There are 3 ways to use the Query Builder: by using parameters, by using access functions, or by combining both.</p> <h3 id="build-a-query-by-using-parameters"><a href="#build-a-query-by-using-parameters" class="header-anchor">#</a> Build a Query by Using Parameters</h3> <p>To create queries by using parameters it is mandatory to define in the query constructor the <a href="/interfaces/iconditionexpr.html#hierarchy"><strong>parameters</strong></a> of the query and the <strong>name</strong> of the collection.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
  select<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      $count<span class="token operator">:</span> <span class="token punctuation">{</span>
        $field<span class="token operator">:</span> <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token string">'type'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">as</span><span class="token operator">:</span> <span class="token string">'odm'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token keyword">let</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> key<span class="token operator">:</span> <span class="token string">'amount_val'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> key<span class="token operator">:</span> <span class="token string">'size_val'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  where<span class="token operator">:</span> <span class="token punctuation">{</span>
    $or<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> price<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token string">'amount_val'</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> auto<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> amount<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    $and<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> price2<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">1.99</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> $or<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> price3<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">1.99</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">'20'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token punctuation">{</span> $eq<span class="token operator">:</span> <span class="token string">'John'</span><span class="token punctuation">,</span> $ignoreCase<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    $<span class="token builtin">any</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      $expr<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> $<span class="token keyword">in</span><span class="token operator">:</span> <span class="token punctuation">{</span> search_expr<span class="token operator">:</span> <span class="token string">'search'</span><span class="token punctuation">,</span> target_expr<span class="token operator">:</span> <span class="token string">'address'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      $satisfies<span class="token operator">:</span> <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token string">'10'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    $<span class="token keyword">in</span><span class="token operator">:</span> <span class="token punctuation">{</span> search_expr<span class="token operator">:</span> <span class="token string">'search'</span><span class="token punctuation">,</span> target_expr<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'address'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  groupBy<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> expr<span class="token operator">:</span> <span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token keyword">as</span><span class="token operator">:</span> <span class="token string">'sch'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  letting<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> key<span class="token operator">:</span> <span class="token string">'amount_v2'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> key<span class="token operator">:</span> <span class="token string">'size_v2'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  having<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token keyword">type</span><span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'%hotel%'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  orderBy<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'DESC'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  limit<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  offset<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'airline_8093'</span><span class="token punctuation">,</span> <span class="token string">'airline_8094'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span>params<span class="token punctuation">,</span> <span class="token string">'travel-sample'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- N1QL query result:</span>
<span class="token keyword">SELECT</span>
  <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> odm
<span class="token keyword">FROM</span>
  <span class="token punctuation">`</span>travel<span class="token operator">-</span>sample<span class="token punctuation">`</span> <span class="token keyword">USE</span> <span class="token keyword">KEYS</span> <span class="token punctuation">[</span><span class="token string">&quot;airline_8093&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;airline_8094&quot;</span><span class="token punctuation">]</span> LET amount_val<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> size_val<span class="token operator">=</span><span class="token number">20</span>
<span class="token keyword">WHERE</span>
  <span class="token punctuation">(</span><span class="token punctuation">(</span> price<span class="token operator">&gt;</span><span class="token string">&quot;amount_val&quot;</span> <span class="token operator">AND</span> price <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token punctuation">)</span> <span class="token operator">OR</span> auto<span class="token operator">&gt;</span><span class="token number">10</span> <span class="token operator">OR</span> amount<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
  <span class="token operator">AND</span> <span class="token punctuation">(</span>
    <span class="token punctuation">(</span>price2<span class="token operator">&gt;</span><span class="token number">1.99</span> <span class="token operator">AND</span> price2 <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span> <span class="token operator">AND</span>
    <span class="token punctuation">(</span><span class="token punctuation">(</span>price3 <span class="token operator">&gt;</span> <span class="token number">1.99</span> <span class="token operator">AND</span> price3 <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span> <span class="token operator">OR</span> id<span class="token operator">=</span><span class="token string">&quot;20&quot;</span><span class="token punctuation">)</span> <span class="token operator">AND</span>
    <span class="token punctuation">(</span>LOWER<span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">=</span> LOWER<span class="token punctuation">(</span><span class="token string">&quot;John&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
  <span class="token operator">AND</span> <span class="token keyword">ANY</span> search <span class="token operator">IN</span> address SATISFIES address<span class="token operator">=</span><span class="token string">&quot;10&quot;</span> <span class="token keyword">END</span>
  <span class="token operator">AND</span> search <span class="token operator">IN</span> <span class="token punctuation">[</span><span class="token string">&quot;address&quot;</span><span class="token punctuation">]</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
  <span class="token keyword">type</span> <span class="token keyword">AS</span> sch LETTING amount_v2<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> size_v2<span class="token operator">=</span><span class="token number">20</span>
<span class="token keyword">HAVING</span>
  <span class="token keyword">type</span> <span class="token operator">LIKE</span> <span class="token string">&quot;%hotel%&quot;</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
  <span class="token keyword">type</span> <span class="token keyword">DESC</span>
<span class="token keyword">LIMIT</span> <span class="token number">10</span> <span class="token keyword">OFFSET</span> <span class="token number">1</span>
</code></pre></div><h3 id="build-a-query-by-using-access-functions"><a href="#build-a-query-by-using-access-functions" class="header-anchor">#</a> Build a Query by Using Access Functions</h3> <p>Creating queries by using the access function is very similar to create them with parameters. The difference is that the parameters are not passed directly to the constructor, instead, they are passed using the different functions available in the Query Class.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> select <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    $count<span class="token operator">:</span> <span class="token punctuation">{</span>
      $field<span class="token operator">:</span> <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">'type'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token keyword">as</span><span class="token operator">:</span> <span class="token string">'odm'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    $max<span class="token operator">:</span> <span class="token punctuation">{</span>
      $field<span class="token operator">:</span> <span class="token string">'amount'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> letExpr <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> key<span class="token operator">:</span> <span class="token string">'amount_val'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> key<span class="token operator">:</span> <span class="token string">'size_val'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> where <span class="token operator">=</span> <span class="token punctuation">{</span>
  $or<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> price<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token string">'amount_val'</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> auto<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> amount<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  $and<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> price2<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">1.99</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> $or<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> price3<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">1.99</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">'20'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> groupBy <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> expr<span class="token operator">:</span> <span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token keyword">as</span><span class="token operator">:</span> <span class="token string">'sch'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> having <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">type</span><span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'%hotel%'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> lettingExpr <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> key<span class="token operator">:</span> <span class="token string">'amount_v2'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> key<span class="token operator">:</span> <span class="token string">'size_v2'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> orderBy <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'DESC'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> limit <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> offset <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> useExpr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'airline_8093'</span><span class="token punctuation">,</span> <span class="token string">'airline_8094'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'collection-name'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>select<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">let</span><span class="token punctuation">(</span>letExpr<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>where<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span>groupBy<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">letting</span><span class="token punctuation">(</span>lettingExpr<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">having</span><span class="token punctuation">(</span>having<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span>orderBy<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span>limit<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span>offset<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">useKeys</span><span class="token punctuation">(</span>useExpr<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- N1QL query result:</span>
<span class="token keyword">SELECT</span>
  <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> odm<span class="token punctuation">,</span> <span class="token function">MAX</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span>
<span class="token keyword">FROM</span>
  <span class="token punctuation">`</span>travel<span class="token operator">-</span>sample<span class="token punctuation">`</span> <span class="token keyword">USE</span> <span class="token keyword">KEYS</span> <span class="token punctuation">[</span><span class="token string">'airline_8093'</span><span class="token punctuation">,</span><span class="token string">'airline_8094'</span><span class="token punctuation">]</span> LET amount_val <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span>size_val <span class="token operator">=</span> <span class="token number">20</span>
<span class="token keyword">WHERE</span>
  <span class="token punctuation">(</span><span class="token punctuation">(</span>price <span class="token operator">&gt;</span> amount_val <span class="token operator">AND</span> price <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span> <span class="token operator">OR</span> auto <span class="token operator">&gt;</span> <span class="token number">10</span> <span class="token operator">OR</span> amount <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span>
  <span class="token operator">AND</span> <span class="token punctuation">(</span>
    <span class="token punctuation">(</span>price2 <span class="token operator">&gt;</span> <span class="token number">1.99</span> <span class="token operator">AND</span> price2 <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span>
    <span class="token operator">AND</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>price3 <span class="token operator">&gt;</span> <span class="token number">1.99</span> <span class="token operator">AND</span> price3 <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span> <span class="token operator">OR</span> id <span class="token operator">=</span> <span class="token string">'20'</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
  <span class="token keyword">type</span> <span class="token keyword">AS</span> sch LETTING amount_v2<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>size_v2<span class="token operator">=</span><span class="token number">20</span>
<span class="token keyword">HAVING</span>
  <span class="token keyword">type</span> <span class="token operator">LIKE</span> <span class="token string">&quot;%hotel%&quot;</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
  <span class="token keyword">type</span> <span class="token operator">=</span> <span class="token string">'DESC'</span>
<span class="token keyword">LIMIT</span> <span class="token number">10</span> <span class="token keyword">OFFSET</span> <span class="token number">1</span>
</code></pre></div><h3 id="build-a-query-by-using-parameters-and-function-parameters"><a href="#build-a-query-by-using-parameters-and-function-parameters" class="header-anchor">#</a> Build a Query by Using Parameters and Function Parameters</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> select <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> $field<span class="token operator">:</span> <span class="token string">'address'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">{</span> where<span class="token operator">:</span> <span class="token punctuation">{</span> price<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'travel-sample'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>select<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- N1QL query result:</span>
<span class="token keyword">SELECT</span>
  address
<span class="token keyword">FROM</span>
  <span class="token punctuation">`</span>travel<span class="token operator">-</span>sample<span class="token punctuation">`</span>
<span class="token keyword">WHERE</span>
  price <span class="token operator">&gt;</span> <span class="token number">5</span>
<span class="token keyword">LIMIT</span> <span class="token number">10</span>
</code></pre></div><h3 id="advanced-example-of-using-the-where-clause"><a href="#advanced-example-of-using-the-where-clause" class="header-anchor">#</a> Advanced Example of Using the WHERE Clause</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> where <span class="token operator">=</span> <span class="token punctuation">{</span>
  $or<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token punctuation">{</span> $isNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> free_breakfast<span class="token operator">:</span> <span class="token punctuation">{</span> $isMissing<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> free_breakfast<span class="token operator">:</span> <span class="token punctuation">{</span> $isNotValued<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $eq<span class="token operator">:</span> <span class="token number">8000</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $neq<span class="token operator">:</span> <span class="token number">9000</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">7000</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $gte<span class="token operator">:</span> <span class="token number">6999</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $lt<span class="token operator">:</span> <span class="token number">5000</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $lte<span class="token operator">:</span> <span class="token number">4999</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  $and<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token punctuation">{</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token punctuation">{</span> $isNotMissing<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token punctuation">{</span> $isValued<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  $not<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      address<span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'%59%'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token punctuation">{</span> $notLike<span class="token operator">:</span> <span class="token string">'Otto%'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      $or<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $btw<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $notBtw<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">2001</span><span class="token punctuation">,</span> <span class="token number">8000</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      address<span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'St%'</span><span class="token punctuation">,</span> $ignoreCase<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'travel-sample'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>where<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- N1QL query result:</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span>
  <span class="token punctuation">`</span>travel<span class="token operator">-</span>sample<span class="token punctuation">`</span>
<span class="token keyword">WHERE</span>
  <span class="token punctuation">(</span>
    address <span class="token operator">IS</span> <span class="token boolean">NULL</span>
    <span class="token operator">OR</span> free_breakfast <span class="token operator">IS</span> MISSING
    <span class="token operator">OR</span> free_breakfast <span class="token operator">IS</span> <span class="token operator">NOT</span> VALUED
    <span class="token operator">OR</span> id <span class="token operator">=</span> <span class="token number">8000</span>
    <span class="token operator">OR</span> id <span class="token operator">!=</span> <span class="token number">9000</span>
    <span class="token operator">OR</span> id <span class="token operator">&gt;</span> <span class="token number">7000</span>
    <span class="token operator">OR</span> id <span class="token operator">&gt;=</span> <span class="token number">6999</span>
    <span class="token operator">OR</span> id <span class="token operator">&lt;</span> <span class="token number">5000</span>
    <span class="token operator">OR</span> id <span class="token operator">&lt;=</span> <span class="token number">4999</span>
  <span class="token punctuation">)</span>
  <span class="token operator">AND</span> <span class="token punctuation">(</span>
    address <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
    <span class="token operator">AND</span> address <span class="token operator">IS</span> <span class="token operator">NOT</span> MISSING
    <span class="token operator">AND</span> address <span class="token operator">IS</span> VALUED
  <span class="token punctuation">)</span>
  <span class="token operator">AND</span> <span class="token operator">NOT</span> <span class="token punctuation">(</span>
    address <span class="token operator">LIKE</span> <span class="token string">&quot;%59%&quot;</span>
    <span class="token operator">AND</span> name <span class="token operator">NOT</span> <span class="token operator">LIKE</span> <span class="token string">&quot;Otto%&quot;</span>
    <span class="token operator">AND</span> <span class="token punctuation">(</span>id <span class="token operator">BETWEEN</span> <span class="token number">1</span> <span class="token operator">AND</span> <span class="token number">2000</span> <span class="token operator">OR</span> id <span class="token operator">NOT</span> <span class="token operator">BETWEEN</span> <span class="token number">2001</span> <span class="token operator">AND</span> <span class="token number">8000</span><span class="token punctuation">)</span>
    <span class="token operator">AND</span> <span class="token punctuation">(</span>LOWER<span class="token punctuation">(</span>address<span class="token punctuation">)</span> <span class="token operator">LIKE</span> LOWER<span class="token punctuation">(</span><span class="token string">&quot;St%&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token keyword">LIMIT</span> <span class="token number">20</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Note</p> <p>Can also use <code>ignoreCase</code> as part of the <code>build</code> method, this will always prioritize the <code>$ignoreCase</code> value defined in clause</p> <div class="language-ts extra-class"><pre class="language-ts"><code>  <span class="token keyword">const</span> expr_where <span class="token operator">=</span> <span class="token punctuation">{</span>
   $or<span class="token operator">:</span> <span class="token punctuation">[</span>
     <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'%57-59%'</span><span class="token punctuation">,</span> $ignoreCase<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// ignoreCase will not be applied</span>
     <span class="token punctuation">{</span> free_breakfast<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token punctuation">{</span> $eq<span class="token operator">:</span> <span class="token string">'John'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token comment">//  ignoreCase will be applied</span>
   <span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * Can also use:
 * const expr_where = {
 *   $or: [
 *     ...
 *     { name:'John' } //  ignoreCase will be applied
 *   ],
 * };
 * 
 */</span>
<span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'travel-sample'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span> $field<span class="token operator">:</span> <span class="token string">'address'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>expr_where<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">{</span> ignoreCase<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ignore case is enabled for where clause elements</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre></div><p>Would have as output:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- N1QL query result:</span>
<span class="token keyword">SELECT</span>
  address
<span class="token keyword">FROM</span>
  <span class="token punctuation">`</span>travel<span class="token operator">-</span>sample<span class="token punctuation">`</span>
<span class="token keyword">WHERE</span>
  <span class="token punctuation">(</span>
    address <span class="token operator">LIKE</span> <span class="token string">&quot;%57-59%&quot;</span>
    <span class="token operator">OR</span> free_breakfast <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token operator">OR</span> <span class="token punctuation">(</span>LOWER<span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">=</span> LOWER<span class="token punctuation">(</span><span class="token string">&quot;John&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <h2 id="n1ql-select-clause-structure"><a href="#n1ql-select-clause-structure" class="header-anchor">#</a> N1QL SELECT Clause Structure</h2> <p>See definition <a href="/classes/query.html#select">here</a></p> <p>The syntax of a SELECT clause in n1ql is documented <a href="https://docs.couchbase.com/server/current/n1ql/n1ql-language-reference/select-syntax.html" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Available Result Expression Arguments:</p> <table><thead><tr><th>key</th> <th>value</th></tr></thead> <tbody><tr><td>$all</td> <td>ALL</td></tr> <tr><td>$distinct</td> <td>DISTINCT</td></tr> <tr><td>$raw</td> <td>RAW</td></tr> <tr><td>$element</td> <td>ELEMENT</td></tr> <tr><td>$value</td> <td>VALUE</td></tr></tbody></table> <p>Available Aggregation Functions:</p> <table><thead><tr><th>key</th> <th>value</th></tr></thead> <tbody><tr><td>$arrayAgg</td> <td>ARRAY_AGG</td></tr> <tr><td>$avg</td> <td>AVG</td></tr> <tr><td>$mean</td> <td>MEAN</td></tr> <tr><td>$count</td> <td>COUNT</td></tr> <tr><td>$countn</td> <td>COUNTN</td></tr> <tr><td>$max</td> <td>MAX</td></tr> <tr><td>$median</td> <td>MEDIAN</td></tr> <tr><td>$min</td> <td>MIN</td></tr> <tr><td>$stddev</td> <td>STDDEV</td></tr> <tr><td>$stddevPop</td> <td>STDDEV_POP</td></tr> <tr><td>$stddevSamp</td> <td>STDDEV_SAMP</td></tr> <tr><td>$sum</td> <td>SUM</td></tr> <tr><td>$variance</td> <td>VARIANCE</td></tr> <tr><td>$variancePop</td> <td>VARIANCE_POP</td></tr> <tr><td>$varianceSamp</td> <td>VARIANCE_SAMP</td></tr> <tr><td>$varPop</td> <td>VAR_SAMP</td></tr> <tr><td>$varSamp</td> <td>VAR_SAMP</td></tr></tbody></table> <h3 id="n1ql-select-nested-clause-example"><a href="#n1ql-select-nested-clause-example" class="header-anchor">#</a> N1QL SELECT Nested Clause Example</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'travel-sample a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> query
  <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span> $field<span class="token operator">:</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'{&quot;latLon&quot;: {geo.lat, geo.lon} }'</span><span class="token punctuation">,</span> <span class="token keyword">as</span><span class="token operator">:</span> <span class="token string">'geo'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">'a.type'</span><span class="token operator">:</span> <span class="token string">'hotel'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>'SELECT {&quot;latLon&quot;: {geo.lat, geo.lon} } AS geo FROM <code>travel-sample</code> a WHERE a.type=&quot;hotel&quot;'</p></blockquote> <h2 id="n1ql-where-clause-structure"><a href="#n1ql-where-clause-structure" class="header-anchor">#</a> N1QL WHERE Clause Structure</h2> <p>See definition <a href="/classes/query.html#where">here</a></p> <p>The syntax of a WHERE clause in n1ql is documented <a href="https://docs.couchbase.com/server/current/n1ql/n1ql-language-reference/where.html" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Available Comparison Operators:</p> <table><thead><tr><th>key</th> <th>value</th></tr></thead> <tbody><tr><td>$isNull</td> <td>IS NULL</td></tr> <tr><td>$isNotNull</td> <td>IS NOT NULL</td></tr> <tr><td>$isMissing</td> <td>IS MISSING</td></tr> <tr><td>$isNotMissing</td> <td>IS NOT MISSING</td></tr> <tr><td>$isValued</td> <td>IS VALUED</td></tr> <tr><td>$isNotValued</td> <td>IS NOT VALUED</td></tr> <tr><td>$eq</td> <td>=</td></tr> <tr><td>$neq</td> <td>!=</td></tr> <tr><td>$gt</td> <td>&gt;</td></tr> <tr><td>$gte</td> <td>&gt;=</td></tr> <tr><td>$lt</td> <td>&lt;</td></tr> <tr><td>$lte</td> <td>&lt;=</td></tr> <tr><td>$like</td> <td>LIKE</td></tr> <tr><td>$notLike</td> <td>NOT LIKE</td></tr> <tr><td>$btw</td> <td>BETWEEN</td></tr> <tr><td>$notBtw</td> <td>NOT BETWEEN</td></tr></tbody></table> <p>Available Logical operators:</p> <table><thead><tr><th>key</th> <th>value</th></tr></thead> <tbody><tr><td>$and</td> <td>AND</td></tr> <tr><td>$or</td> <td>OR</td></tr> <tr><td>$not</td> <td>NOT</td></tr></tbody></table> <p>Available COLLECTION operators:</p> <table><thead><tr><th>key</th> <th>value</th></tr></thead> <tbody><tr><td>$any</td> <td>ANY</td></tr> <tr><td>$every</td> <td>EVERY</td></tr> <tr><td>$in</td> <td>IN</td></tr> <tr><td>$within</td> <td>WITHIN</td></tr> <tr><td>$satisfies</td> <td>SATISFIES</td></tr></tbody></table> <p>Available String Modifiers:</p> <table><thead><tr><th>key</th> <th>value</th></tr></thead> <tbody><tr><td>$ignoreCase</td> <td>Boolean</td></tr></tbody></table> <h2 id="n1ql-join-clause-structure"><a href="#n1ql-join-clause-structure" class="header-anchor">#</a> N1QL JOIN Clause Structure</h2> <p>Notice: Currently the JOIN clause is only supported in string format.</p> <p>See definition <a href="/classes/query.html#plainJoin">here</a></p> <p>The syntax of a JOIN clause in n1ql is documented <a href="https://docs.couchbase.com/server/6.5/n1ql/n1ql-language-reference/join.html" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="n1ql-group-by-clause-structure"><a href="#n1ql-group-by-clause-structure" class="header-anchor">#</a> N1QL GROUP BY Clause Structure</h2> <p>See definition <a href="/classes/query.html#groupby">here</a></p> <p>The syntax of a GROUP BY clause in n1ql is documented <a href="https://docs.couchbase.com/server/6.5/n1ql/n1ql-language-reference/groupby.html" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.42729f85.js" defer></script><script src="/assets/js/2.a7ba359b.js" defer></script><script src="/assets/js/65.0ce04018.js" defer></script>
  </body>
</html>
