<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Model | Ottoman.js</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Ottoman is an ODM built for Couchbase and Node.js. ">
    
    <link rel="preload" href="/assets/css/0.styles.53ef105f.css" as="style"><link rel="preload" href="/assets/js/app.765cd436.js" as="script"><link rel="preload" href="/assets/js/2.8041a87f.js" as="script"><link rel="preload" href="/assets/js/65.2d7758b2.js" as="script"><link rel="prefetch" href="/assets/js/10.4f472a76.js"><link rel="prefetch" href="/assets/js/100.eb9fd8ef.js"><link rel="prefetch" href="/assets/js/101.149bc007.js"><link rel="prefetch" href="/assets/js/102.8b6e5d51.js"><link rel="prefetch" href="/assets/js/103.049d50f3.js"><link rel="prefetch" href="/assets/js/11.31a6696f.js"><link rel="prefetch" href="/assets/js/12.76b10080.js"><link rel="prefetch" href="/assets/js/13.14da574c.js"><link rel="prefetch" href="/assets/js/14.bfc01d18.js"><link rel="prefetch" href="/assets/js/15.bf165d18.js"><link rel="prefetch" href="/assets/js/16.5f93e03e.js"><link rel="prefetch" href="/assets/js/17.37ebb36e.js"><link rel="prefetch" href="/assets/js/18.cf449a4b.js"><link rel="prefetch" href="/assets/js/19.15fa841e.js"><link rel="prefetch" href="/assets/js/20.cd2c9c2b.js"><link rel="prefetch" href="/assets/js/21.d6ba8a6f.js"><link rel="prefetch" href="/assets/js/22.9e084de5.js"><link rel="prefetch" href="/assets/js/23.c516a260.js"><link rel="prefetch" href="/assets/js/24.aa4c38bf.js"><link rel="prefetch" href="/assets/js/25.7089f74c.js"><link rel="prefetch" href="/assets/js/26.43ff17f8.js"><link rel="prefetch" href="/assets/js/27.34a6d3dd.js"><link rel="prefetch" href="/assets/js/28.e03df60a.js"><link rel="prefetch" href="/assets/js/29.f460ecfd.js"><link rel="prefetch" href="/assets/js/3.c30b6ebf.js"><link rel="prefetch" href="/assets/js/30.b234ce08.js"><link rel="prefetch" href="/assets/js/31.cc44a717.js"><link rel="prefetch" href="/assets/js/32.a3eb34f4.js"><link rel="prefetch" href="/assets/js/33.8be18e34.js"><link rel="prefetch" href="/assets/js/34.c9499cfe.js"><link rel="prefetch" href="/assets/js/35.5c1d509d.js"><link rel="prefetch" href="/assets/js/36.21c0c53a.js"><link rel="prefetch" href="/assets/js/37.2a37e550.js"><link rel="prefetch" href="/assets/js/38.4dfcf158.js"><link rel="prefetch" href="/assets/js/39.6d5b7f58.js"><link rel="prefetch" href="/assets/js/4.9b3712fa.js"><link rel="prefetch" href="/assets/js/40.76fbf9ba.js"><link rel="prefetch" href="/assets/js/41.d334cf0e.js"><link rel="prefetch" href="/assets/js/42.90124a88.js"><link rel="prefetch" href="/assets/js/43.d6bb2acd.js"><link rel="prefetch" href="/assets/js/44.939ca312.js"><link rel="prefetch" href="/assets/js/45.b1f4f545.js"><link rel="prefetch" href="/assets/js/46.7073cdb4.js"><link rel="prefetch" href="/assets/js/47.163b82b6.js"><link rel="prefetch" href="/assets/js/48.4e47a06b.js"><link rel="prefetch" href="/assets/js/49.62943b68.js"><link rel="prefetch" href="/assets/js/5.a133a7a2.js"><link rel="prefetch" href="/assets/js/50.33d5f3e4.js"><link rel="prefetch" href="/assets/js/51.8be8d7f4.js"><link rel="prefetch" href="/assets/js/52.a898e32a.js"><link rel="prefetch" href="/assets/js/53.b0db8514.js"><link rel="prefetch" href="/assets/js/54.f37c804d.js"><link rel="prefetch" href="/assets/js/55.4e4ec0b8.js"><link rel="prefetch" href="/assets/js/56.a2fb1782.js"><link rel="prefetch" href="/assets/js/57.4850c419.js"><link rel="prefetch" href="/assets/js/58.7e2069d2.js"><link rel="prefetch" href="/assets/js/59.0a804681.js"><link rel="prefetch" href="/assets/js/6.fbdd231c.js"><link rel="prefetch" href="/assets/js/60.546f68db.js"><link rel="prefetch" href="/assets/js/61.f850e1a7.js"><link rel="prefetch" href="/assets/js/62.8eed5773.js"><link rel="prefetch" href="/assets/js/63.21abbd81.js"><link rel="prefetch" href="/assets/js/64.1c368fd1.js"><link rel="prefetch" href="/assets/js/66.570a8640.js"><link rel="prefetch" href="/assets/js/67.97b184a9.js"><link rel="prefetch" href="/assets/js/68.6b9b31ce.js"><link rel="prefetch" href="/assets/js/69.c94dcc4d.js"><link rel="prefetch" href="/assets/js/7.1bdf3a92.js"><link rel="prefetch" href="/assets/js/70.5d0e2d4f.js"><link rel="prefetch" href="/assets/js/71.423c16e6.js"><link rel="prefetch" href="/assets/js/72.11021aa3.js"><link rel="prefetch" href="/assets/js/73.4776b6dc.js"><link rel="prefetch" href="/assets/js/74.26879080.js"><link rel="prefetch" href="/assets/js/75.62763d19.js"><link rel="prefetch" href="/assets/js/76.64364fa7.js"><link rel="prefetch" href="/assets/js/77.7be4ef5a.js"><link rel="prefetch" href="/assets/js/78.e5610220.js"><link rel="prefetch" href="/assets/js/79.cbb92e71.js"><link rel="prefetch" href="/assets/js/8.42df8c46.js"><link rel="prefetch" href="/assets/js/80.60fe56a8.js"><link rel="prefetch" href="/assets/js/81.05d5bf7b.js"><link rel="prefetch" href="/assets/js/82.7d825c8f.js"><link rel="prefetch" href="/assets/js/83.4d0eaf0c.js"><link rel="prefetch" href="/assets/js/84.48383980.js"><link rel="prefetch" href="/assets/js/85.c959e0f9.js"><link rel="prefetch" href="/assets/js/86.7320b29c.js"><link rel="prefetch" href="/assets/js/87.b4833b78.js"><link rel="prefetch" href="/assets/js/88.bd7e0226.js"><link rel="prefetch" href="/assets/js/89.a384502d.js"><link rel="prefetch" href="/assets/js/9.213b280c.js"><link rel="prefetch" href="/assets/js/90.3aff33a7.js"><link rel="prefetch" href="/assets/js/91.879f9bd9.js"><link rel="prefetch" href="/assets/js/92.0b183074.js"><link rel="prefetch" href="/assets/js/93.7a4cfe65.js"><link rel="prefetch" href="/assets/js/94.b1f1ef18.js"><link rel="prefetch" href="/assets/js/95.713eb703.js"><link rel="prefetch" href="/assets/js/96.4622a4a8.js"><link rel="prefetch" href="/assets/js/97.aaff6931.js"><link rel="prefetch" href="/assets/js/98.f07aee25.js"><link rel="prefetch" href="/assets/js/99.ba4976ac.js">
    <link rel="stylesheet" href="/assets/css/0.styles.53ef105f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Ottoman.js</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guides/faq.html" class="nav-link">
  FAQ
</a></div><div class="nav-item"><a href="/guides/quick-start.html" class="nav-link">
  Quick Start
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Basic" class="dropdown-title"><span class="title">Basic</span> <span class="arrow down"></span></button> <button type="button" aria-label="Basic" class="mobile-dropdown-title"><span class="title">Basic</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guides/ottoman.html" class="nav-link">
  Ottoman
</a></li><li class="dropdown-item"><!----> <a href="/guides/schema.html" class="nav-link">
  Schema
</a></li><li class="dropdown-item"><!----> <a href="/guides/model.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/guides/document.html" class="nav-link">
  Document
</a></li><li class="dropdown-item"><!----> <a href="/guides/query-builder.html" class="nav-link">
  Query Builder
</a></li><li class="dropdown-item"><!----> <a href="/guides/mongoose-to-couchbase.html" class="nav-link">
  Mongoose to Ottoman
</a></li><li class="dropdown-item"><!----> <a href="/guides/ottoman-couchbase.html" class="nav-link">
  Ottoman for Couchbase Node.js SDK devs
</a></li><li class="dropdown-item"><!----> <a href="/guides/ottomanV1-to-ottomanV2.html" class="nav-link">
  Ottoman V1 to Ottoman V2
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Advanced" class="dropdown-title"><span class="title">Advanced</span> <span class="arrow down"></span></button> <button type="button" aria-label="Advanced" class="mobile-dropdown-title"><span class="title">Advanced</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advanced/how-ottoman-works.html" class="nav-link">
  How Ottoman Works
</a></li><li class="dropdown-item"><!----> <a href="/advanced/ottoman.html" class="nav-link">
  Ottoman
</a></li></ul></div></div><div class="nav-item"><a href="/guides/first-app.html" class="nav-link">
  Example
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="API" class="dropdown-title"><span class="title">API</span> <span class="arrow down"></span></button> <button type="button" aria-label="API" class="mobile-dropdown-title"><span class="title">API</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/classes/ottoman.html" class="nav-link">
  Ottoman
</a></li><li class="dropdown-item"><!----> <a href="/classes/schema.html" class="nav-link">
  Schema
</a></li><li class="dropdown-item"><!----> <a href="/classes/model.html" class="nav-link">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/classes/document.html" class="nav-link">
  Document
</a></li><li class="dropdown-item"><!----> <a href="/classes/query.html" class="nav-link">
  Query Builder
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/couchbaselabs/node-ottoman" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guides/faq.html" class="nav-link">
  FAQ
</a></div><div class="nav-item"><a href="/guides/quick-start.html" class="nav-link">
  Quick Start
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Basic" class="dropdown-title"><span class="title">Basic</span> <span class="arrow down"></span></button> <button type="button" aria-label="Basic" class="mobile-dropdown-title"><span class="title">Basic</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guides/ottoman.html" class="nav-link">
  Ottoman
</a></li><li class="dropdown-item"><!----> <a href="/guides/schema.html" class="nav-link">
  Schema
</a></li><li class="dropdown-item"><!----> <a href="/guides/model.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/guides/document.html" class="nav-link">
  Document
</a></li><li class="dropdown-item"><!----> <a href="/guides/query-builder.html" class="nav-link">
  Query Builder
</a></li><li class="dropdown-item"><!----> <a href="/guides/mongoose-to-couchbase.html" class="nav-link">
  Mongoose to Ottoman
</a></li><li class="dropdown-item"><!----> <a href="/guides/ottoman-couchbase.html" class="nav-link">
  Ottoman for Couchbase Node.js SDK devs
</a></li><li class="dropdown-item"><!----> <a href="/guides/ottomanV1-to-ottomanV2.html" class="nav-link">
  Ottoman V1 to Ottoman V2
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Advanced" class="dropdown-title"><span class="title">Advanced</span> <span class="arrow down"></span></button> <button type="button" aria-label="Advanced" class="mobile-dropdown-title"><span class="title">Advanced</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advanced/how-ottoman-works.html" class="nav-link">
  How Ottoman Works
</a></li><li class="dropdown-item"><!----> <a href="/advanced/ottoman.html" class="nav-link">
  Ottoman
</a></li></ul></div></div><div class="nav-item"><a href="/guides/first-app.html" class="nav-link">
  Example
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="API" class="dropdown-title"><span class="title">API</span> <span class="arrow down"></span></button> <button type="button" aria-label="API" class="mobile-dropdown-title"><span class="title">API</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/classes/ottoman.html" class="nav-link">
  Ottoman
</a></li><li class="dropdown-item"><!----> <a href="/classes/schema.html" class="nav-link">
  Schema
</a></li><li class="dropdown-item"><!----> <a href="/classes/model.html" class="nav-link">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/classes/document.html" class="nav-link">
  Document
</a></li><li class="dropdown-item"><!----> <a href="/classes/query.html" class="nav-link">
  Query Builder
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/couchbaselabs/node-ottoman" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Model</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guides/model.html#compiling-your-first-model" class="sidebar-link">Compiling Your First Model</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guides/model.html#model-options" class="sidebar-link">Model Options</a></li><li class="sidebar-sub-header"><a href="/guides/model.html#model-id" class="sidebar-link">Model Id</a></li></ul></li><li><a href="/guides/model.html#constructing-documents" class="sidebar-link">Constructing Documents</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guides/model.html#create-many" class="sidebar-link">Create Many</a></li></ul></li><li><a href="/guides/model.html#querying" class="sidebar-link">Querying</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guides/model.html#advanced-use-of-select-parameter" class="sidebar-link">Advanced Use of Select Parameter</a></li><li class="sidebar-sub-header"><a href="/guides/model.html#advanced-use-of-filter-parameter" class="sidebar-link">Advanced Use of Filter Parameter</a></li><li class="sidebar-sub-header"><a href="/guides/model.html#use-of-ignorecase" class="sidebar-link">Use of ignoreCase</a></li><li class="sidebar-sub-header"><a href="/guides/model.html#use-of-lean" class="sidebar-link">Use of lean</a></li><li class="sidebar-sub-header"><a href="/guides/model.html#use-lean-and-populate" class="sidebar-link">Use lean and  populate</a></li></ul></li><li><a href="/guides/model.html#deleting" class="sidebar-link">Deleting</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/guides/model.html#updating" class="sidebar-link">Updating</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/guides/model.html#handling-multilpe-models" class="sidebar-link">Handling Multilpe Models</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guides/model.html#getting-existing-models" class="sidebar-link">Getting Existing Models</a></li><li class="sidebar-sub-header"><a href="/guides/model.html#drop-collection" class="sidebar-link">Drop Collection</a></li></ul></li><li><a href="/guides/model.html#next-up" class="sidebar-link">Next Up</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="model"><a href="#model" class="header-anchor">#</a> Model</h1> <p><a href="/classes/model.html">Models</a> are fancy constructors compiled from <a href="/guides/schema">Schema</a> definitions.</p> <p>An instance of a model is called a <a href="/guides/document.html">document</a>.</p> <p>Models are responsible for creating and reading documents from the underlying Couchbase database.</p> <h2 id="compiling-your-first-model"><a href="#compiling-your-first-model" class="header-anchor">#</a> Compiling Your First Model</h2> <p>When you call <a href="/classes/ottoman.html#model">model()</a> function on a schema, Ottoman compiles a model for you.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> schema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> String<span class="token punctuation">,</span> age<span class="token operator">:</span> Number <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> User <span class="token operator">=</span> <span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> schema<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>The <a href="/classes/ottoman.html#model">model()</a> function makes a copy of the <code>schema</code>. Make sure that you've added everything you want to the <code>schema</code>, including hooks, before calling <code>model()</code>!</p></div> <h3 id="model-options"><a href="#model-options" class="header-anchor">#</a> Model Options</h3> <p>You can pass a third argument to <a href="/classes/ottoman.html#model">model()</a> functions in order to setup your needs.
In the next example we will set the <code>collectionName</code> to be <code>users</code>.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> schema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> String<span class="token punctuation">,</span> age<span class="token operator">:</span> Number <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> User <span class="token operator">=</span> <span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> schema<span class="token punctuation">,</span> <span class="token punctuation">{</span> collectionName<span class="token operator">:</span> <span class="token string">'users'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Defining Collection Name</p> <p>Models will be mapped to your Collections, if no Collection name option is provided then the Collection name will be equal to the Model name.
There is an exception to this rule:</p> <ul><li><p>If you provide a <code>collectionName</code> option at Ottoman instance level then the Collection name will be equal to Ottoman <code>collectionName</code> option
if it's not explicitly passed as <code>collectionName</code> in model options.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Ottoman <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'ottoman'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> ottoman <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Ottoman</span><span class="token punctuation">(</span><span class="token punctuation">{</span> collectionName<span class="token operator">:</span> <span class="token string">'_default'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> schema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> String<span class="token punctuation">,</span> age<span class="token operator">:</span> Number <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Collection name for model `Cat` will be `_default`</span>
<span class="token keyword">const</span> Cat <span class="token operator">=</span> ottoman<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Cat'</span><span class="token punctuation">,</span> schema<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Collection name for model `Dog` will be `dogs`</span>
<span class="token keyword">const</span> Dog <span class="token operator">=</span> ottoman<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Dog'</span><span class="token punctuation">,</span> schema<span class="token punctuation">,</span> <span class="token punctuation">{</span> collectionName<span class="token operator">:</span> <span class="token string">'dogs'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Therefore this is the way to get the Collection name for a Model:
Collection Name = Model <code>collectionName</code> Options &gt; Ottoman <code>collectionName</code> Options &gt; Model name</p></li></ul></div> <p>The models options are:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">ModelOptions</span> <span class="token punctuation">{</span>
  collectionName<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  scopeName<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  idKey<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  modelKey<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  maxExpiry<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  keyGenerator<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>params<span class="token operator">:</span> <span class="token punctuation">{</span> metadata<span class="token operator">:</span> ModelMetadata <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  keyGeneratorDelimiter<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>collectionName</code>: define the collection name to be use in the Couchbase Server. The default value will be the Model's name.</li> <li><code>scopeName</code>: define the scope where the collection will be placed. The default value is <code>_default</code></li> <li><code>idKey</code>: it's the value of the key to save your id. The default value is set to 'id'.</li> <li><code>modelKey</code>: define the key to store the model name into the document. The default value is <code>_type</code></li> <li><code>maxExpiry</code>: value used to create a collection for this instance. The default value is <code>0</code>.</li> <li><code>keyGenerator</code>: function to generate the key to store documents.</li> <li><code>keyGeneratorDelimiter</code>: string value used to build the document key. The default value is <code>::</code></li></ul> <p>If you don't provided a <code>keyGenerator</code> or <code>keyGeneratorDelimiter</code> implementation it will be inherited by <code>Ottoman</code> instance options, check this in <a href="/guides/ottoman.html#ottoman-constructor-options">Ottoman options</a></p> <h3 id="model-id"><a href="#model-id" class="header-anchor">#</a> Model Id</h3> <p>Ottoman will generate automatically your document's <code>id</code> and will guarantee that each <code>id</code> will be unique.</p> <p>Each document's <code>id</code> will be included on the document under a property called <code>id</code> by default.</p> <p>The <code>id</code> property name can be modified using the <code>ModelOptions.idKey</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> schema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> String<span class="token punctuation">,</span> age<span class="token operator">:</span> Number <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> User <span class="token operator">=</span> <span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> schema<span class="token punctuation">,</span> <span class="token punctuation">{</span> collectionName<span class="token operator">:</span> <span class="token string">'users'</span><span class="token punctuation">,</span> idKey<span class="token operator">:</span> <span class="token string">'__id'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The above example will override the default <code>id</code> with <code>__id</code>, now for the <code>User</code>'s documents you can get the <code>id</code> value from doc.__id.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>You can also get the <code>id</code> value by calling the <code>doc._getId()</code> methods, regardless of the <code>id</code> property name.</p></div> <h2 id="constructing-documents"><a href="#constructing-documents" class="header-anchor">#</a> Constructing Documents</h2> <p>An instance of a model is called a <a href="/guides/document">document</a>. Creating and saving them to the database is easy.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> User <span class="token operator">=</span> <span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> schema<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Jane'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">29</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

user<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// saved!</span>

User<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Jane'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">29</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// also saved!</span>
</code></pre></div><p>Note that no users will be created/removed until the connection that your model uses is open.
Every model has an associated connection. When you use <a href="/classes/ottoman.html#model">model()</a>,
your model will use the default Ottoman connection.</p> <h3 id="create-many"><a href="#create-many" class="header-anchor">#</a> Create Many</h3> <p>Also, you can use <code>createMany</code> static function to create multiples documents at once.
See the <a href="/classes/model.html#static-createmany">API</a> docs for more detail.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>User<span class="token punctuation">.</span><span class="token function">createMany</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'John'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Jane'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>The response status will be <strong>SUCCESS</strong> as long as no error occurs, otherwise it will be <strong>FAILURE</strong>.</p></div> <h2 id="querying"><a href="#querying" class="header-anchor">#</a> Querying</h2> <p>Finding documents is easy with Ottoman, powered by the built-in Query Builder.
Documents can be retrieved using each <code>models</code> <a href="/interfaces/imodel.html#find">find</a>, <a href="/interfaces/imodel.html#findbyid">findById</a>, <a href="/interfaces/imodel.html#findone">findOne</a>, defined <a href="/guides/schema.html#indexes">indexes</a> or where <a href="/guides/schema.html#statics">static methods</a>.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>User<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Jane'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// will return a list of all users with the name &quot;Jane&quot;</span>

User<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Jane'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> limit<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// will return a list of all users with the name &quot;Jane&quot; and limited to 10 items</span>

User<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token punctuation">{</span>$eq<span class="token operator">:</span> <span class="token string">'Jane'</span><span class="token punctuation">,</span> $ignoreCase<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// In some cases you need to compare without taking into account case sensitive, for this you can use the $ ignoreCase property: true</span>

</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>User<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Jane'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// will return a document with a User with the name &quot;Jane&quot; or null in case of not finding it</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>User<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token string">'userId'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// will return the user document with the current id</span>

User<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token string">'userId'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> select<span class="token operator">:</span> <span class="token string">'name, cards'</span><span class="token punctuation">,</span> populate<span class="token operator">:</span> <span class="token string">'cards'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// will return the user document with the current id only with the fields name and cards populated</span>
</code></pre></div><p>The find options are: <a href="/classes/findoptions.html#hierarchy">link</a></p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">IFindOptions</span> <span class="token punctuation">{</span>
  skip<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  limit<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  sort<span class="token operator">?</span><span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> SortType<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  populate<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  populateMaxDeep<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  select<span class="token operator">?</span><span class="token operator">:</span> ISelectType<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  consistency<span class="token operator">?</span><span class="token operator">:</span> SearchConsistency<span class="token punctuation">;</span>
  noCollection<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  lean<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  ignoreCase<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="advanced-use-of-select-parameter"><a href="#advanced-use-of-select-parameter" class="header-anchor">#</a> Advanced Use of Select Parameter</h3> <p>You can select nested objects using the structure defined in the N1QL Language documentation <a href="/guides/[https://docs.couchbase.com/server/current/n1ql/n1ql-language-reference/constructionops.html">Link</a></p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>User<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'john'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>select<span class="token operator">:</span> <span class="token string">'{&quot;latLon&quot;: {geo.lat, geo.lon}, geo.lat} as geo  }'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="advanced-use-of-filter-parameter"><a href="#advanced-use-of-filter-parameter" class="header-anchor">#</a> Advanced Use of Filter Parameter</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> filter <span class="token operator">=</span> <span class="token punctuation">{</span>
  $or<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> price<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token string">'amount_val'</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> auto<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> amount<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  $and<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> price2<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">1.99</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> $or<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> price3<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">1.99</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">'20'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
User<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>filter<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Returns a list of the elements that match the applied filters</span>
</code></pre></div><h3 id="use-of-ignorecase"><a href="#use-of-ignorecase" class="header-anchor">#</a> Use of <code>ignoreCase</code></h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">// Defining `User` schema</span>
<span class="token keyword">const</span> userSchema <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> String<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// Some test documents</span>
<span class="token keyword">const</span> user1 <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'COUCHBASE'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> user2 <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'couchbase'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Create and save `User` model</span>
<span class="token keyword">const</span> UserModel <span class="token operator">=</span> <span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> userSchema<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>user1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>user2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>Without <code>ignoreCase</code></li></ul> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> rows<span class="token operator">:</span> documents <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token punctuation">{</span> $eq<span class="token operator">:</span> <span class="token string">'Couchbase'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> lean<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Documents: </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> documents<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Will get:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$<span class="token operator">&gt;</span> Documents:  <span class="token punctuation">[</span><span class="token punctuation">]</span>
</code></pre></div><ul><li>Using <code>$ignoreCase</code> in filters params</li></ul> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> rows<span class="token operator">:</span> documents <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token punctuation">{</span> $eq<span class="token operator">:</span> <span class="token string">'Couchbase'</span><span class="token punctuation">,</span> $ignoreCase<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// Find filters</span>
    <span class="token punctuation">{</span> lean<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token comment">// Find options</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Documents: </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> documents<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>Using <code>ignoreCase</code> in find options</li></ul> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> rows<span class="token operator">:</span> documents <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'Couch%'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// Find filters</span>
    <span class="token punctuation">{</span> lean<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> ignoreCase<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token comment">// Find options</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Could also use:</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> rows<span class="token operator">:</span> documents <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>
        <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Couchbase'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// Find filters</span>
        <span class="token punctuation">{</span> lean<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> ignoreCase<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token comment">// Find options</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Documents: </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> documents<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>For the two previous examples will get something like this:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$<span class="token operator">&gt;</span> Documents: <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    _type: <span class="token string">'User'</span>,
    id: <span class="token string">'da520506-11c3-4f66-b36c-6cb38d51fd16'</span>,
    name: <span class="token string">'COUCHBASE'</span>
  <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span>
    _type: <span class="token string">'User'</span>,
    id: <span class="token string">'97a3b89e-9c2e-4a75-86d0-f83a5b6f3aa3'</span>,
    name: <span class="token string">'couchbase'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Note</p> <p>Using <code>ignoreCase</code> as part of find functions options will always prioritize the value of <code>$ignoreCase</code> defined in the clause</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>UserModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'NY-%'</span><span class="token punctuation">,</span> $ignoreCase<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// ignoreCase will not be applied</span>
  <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'John'</span> <span class="token punctuation">}</span> <span class="token comment">//  ignoreCase will be applied</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> ignoreCase<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <p>See the chapter on queries for more details on how to use the <a href="/guides/query-builder">Query</a> API.</p> <h3 id="use-of-lean"><a href="#use-of-lean" class="header-anchor">#</a> Use of <code>lean</code></h3> <p>By default, Ottoman queries return an instance of the <a href="/classes/document.html">Ottoman Document class</a>. Documents have a lot of internal state for change tracking. Enabling the <a href="/classes/findoptions.html#optional-lean"><code>lean</code></a> option tells Ottoman to skip instantiating a full Ottoman Document and just give you the plain old JavaScript object (POJO).</p> <p>The <code>lean</code> feature is only for the documents (Models instances) query functions like <a href="/interfaces/imodel.html#find">find</a>, <a href="/interfaces/imodel.html#findbyid">findById</a>, <a href="/interfaces/imodel.html#findone">findOne</a>, etc.</p> <blockquote><p>In Ottoman when <code>lean</code> option is enabled we return an object using a spread operator, all methods, hooks, etc. are removed.</p></blockquote> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> UserModel <span class="token operator">=</span> <span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> schema<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> document <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token punctuation">{</span> lean<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> document1 <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// with lean:true</span>
<span class="token comment">// Under the hood, after executing a query, Ottoman converts the query results </span>
<span class="token comment">// from POJOs to Ottoman Documents. If you turn on the lean option, Ottoman skips this step.</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>document <span class="token keyword">instanceof</span> <span class="token class-name">UserModel</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>document <span class="token keyword">instanceof</span> <span class="token class-name">Model</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>document <span class="token keyword">instanceof</span> <span class="token class-name">Document</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>document <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'Object'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token comment">// with lean:false</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>document1 <span class="token keyword">instanceof</span> <span class="token class-name">UserModel</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>document1 <span class="token keyword">instanceof</span> <span class="token class-name">Model</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>document1 <span class="token keyword">instanceof</span> <span class="token class-name">Document</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>document1 <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>document1<span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'_Model'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p><a href="/classes/manyqueryresponse.html">ManyQueryResponse</a> is an util class and doesn't have this <code>lean</code> feature.</p></div> <h3 id="use-lean-and-populate"><a href="#use-lean-and-populate" class="header-anchor">#</a> Use <code>lean</code> and  <code>populate</code></h3> <p>If you use both <code>populate</code> and <code>lean</code>, the <code>lean</code> option propagates to the populated documents as well. In the below example you can see it:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Define schemas</span>
<span class="token keyword">const</span> IssueSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  title<span class="token operator">:</span> String<span class="token punctuation">,</span>
  description<span class="token operator">:</span> String<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> CardSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cardNumber<span class="token operator">:</span> String<span class="token punctuation">,</span>
  zipCode<span class="token operator">:</span> String<span class="token punctuation">,</span>
  issues<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> type<span class="token operator">:</span> IssueSchema<span class="token punctuation">,</span> ref<span class="token operator">:</span> <span class="token string">'Issue'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> CatSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> String<span class="token punctuation">,</span>
  age<span class="token operator">:</span> Number<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> UserSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token operator">:</span> String<span class="token punctuation">,</span>
  isActive<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
  name<span class="token operator">:</span> String<span class="token punctuation">,</span>
  card<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> CardSchema<span class="token punctuation">,</span> ref<span class="token operator">:</span> <span class="token string">'Card'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  cats<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> type<span class="token operator">:</span> CatSchema<span class="token punctuation">,</span> ref<span class="token operator">:</span> <span class="token string">'Cat'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Create models</span>
<span class="token keyword">const</span> Issue <span class="token operator">=</span> <span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Issue'</span><span class="token punctuation">,</span> IssueSchema<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Card <span class="token operator">=</span> <span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Card'</span><span class="token punctuation">,</span> CardSchema<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Cat <span class="token operator">=</span> <span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Cat'</span><span class="token punctuation">,</span> CatSchema<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> User <span class="token operator">=</span> <span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> UserSchema<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Start Ottoman instance</span>
<span class="token keyword">const</span> ottoman <span class="token operator">=</span> <span class="token function">getDefaultInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> ottoman<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Initialize data</span>
<span class="token keyword">const</span> issueDoc <span class="token operator">=</span> <span class="token keyword">await</span> Issue<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">'stolen card'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cardDoc <span class="token operator">=</span> <span class="token keyword">await</span> Card<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cardNumber<span class="token operator">:</span> <span class="token string">'4242 4242 4242 4242'</span><span class="token punctuation">,</span>
  zipCode<span class="token operator">:</span> <span class="token string">'42424'</span><span class="token punctuation">,</span>
  issues<span class="token operator">:</span> <span class="token punctuation">[</span>issueDoc<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cat1Doc <span class="token operator">=</span> <span class="token keyword">await</span> Cat<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Figaro'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cat2Doc <span class="token operator">=</span> <span class="token keyword">await</span> Cat<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Garfield'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">27</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> userDoc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token operator">:</span> <span class="token string">'userPopulate'</span><span class="token punctuation">,</span>
  isActive<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  name<span class="token operator">:</span> <span class="token string">'John Torvald'</span><span class="token punctuation">,</span>
  card<span class="token operator">:</span> cardDoc<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
  cats<span class="token operator">:</span> <span class="token punctuation">[</span>cat1Doc<span class="token punctuation">.</span>id<span class="token punctuation">,</span> cat2Doc<span class="token punctuation">.</span>id<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> saved <span class="token operator">=</span> <span class="token keyword">await</span> userDoc<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Define query options</span>
<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span> select<span class="token operator">:</span> <span class="token string">'card, cats, name'</span><span class="token punctuation">,</span> populate<span class="token operator">:</span> <span class="token string">'*'</span><span class="token punctuation">,</span> lean<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Execute a lean=true query</span>
<span class="token keyword">const</span> userWithLean <span class="token operator">=</span> <span class="token keyword">await</span> User<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>saved<span class="token punctuation">.</span>id<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Execute a lean=false query</span>
options<span class="token punctuation">.</span>lean <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> userWithoutLean <span class="token operator">=</span> <span class="token keyword">await</span> User<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>saved<span class="token punctuation">.</span>id<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>userWithLean<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>userWithoutLean<span class="token punctuation">)</span><span class="token punctuation">;</span>

ottoman<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>With <code>lean</code> will get a POJO output:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token punctuation">{</span>
  card: <span class="token punctuation">{</span>
    cardNumber: <span class="token string">'4242 4242 4242 4242'</span>,
    zipCode: <span class="token string">'42424'</span>,
    issues: <span class="token punctuation">[</span> <span class="token string">'794f6771-6f8b-417d-a814-1b535176824f'</span> <span class="token punctuation">]</span>,
    id: <span class="token string">'c725c1f5-68dc-4e3a-9b89-58ce52185f24'</span>,
    _type: <span class="token string">'Card'</span>
  <span class="token punctuation">}</span>,
  cats: <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      name: <span class="token string">'Figaro'</span>,
      age: <span class="token number">6</span>,
      id: <span class="token string">'84fc7fca-6099-4299-a03a-286f7464457e'</span>,
      _type: <span class="token string">'Cat'</span>
    <span class="token punctuation">}</span>,
    <span class="token punctuation">{</span>
      name: <span class="token string">'Garfield'</span>,
      age: <span class="token number">27</span>,
      id: <span class="token string">'0acbb8f7-6771-4468-bd21-8de7739cadcb'</span>,
      _type: <span class="token string">'Cat'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>,
  name: <span class="token string">'John Torvald'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Without <code>lean</code> output:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>_Model <span class="token punctuation">{</span>
  card: _Model <span class="token punctuation">{</span>
    cardNumber: <span class="token string">'4242 4242 4242 4242'</span>,
    zipCode: <span class="token string">'42424'</span>,
    issues: <span class="token punctuation">[</span> <span class="token string">'794f6771-6f8b-417d-a814-1b535176824f'</span> <span class="token punctuation">]</span>,
    id: <span class="token string">'c725c1f5-68dc-4e3a-9b89-58ce52185f24'</span>,
    _type: <span class="token string">'Card'</span>
  <span class="token punctuation">}</span>,
  cats: <span class="token punctuation">[</span>
    _Model <span class="token punctuation">{</span>
      name: <span class="token string">'Figaro'</span>,
      age: <span class="token number">6</span>,
      id: <span class="token string">'84fc7fca-6099-4299-a03a-286f7464457e'</span>,
      _type: <span class="token string">'Cat'</span>
    <span class="token punctuation">}</span>,
    _Model <span class="token punctuation">{</span>
      name: <span class="token string">'Garfield'</span>,
      age: <span class="token number">27</span>,
      id: <span class="token string">'0acbb8f7-6771-4468-bd21-8de7739cadcb'</span>,
      _type: <span class="token string">'Cat'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>,
  name: <span class="token string">'John Torvald'</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>If we try to call <code>userWithLean.toJSON()</code> will get <code>TypeError: userWithLean.toJSON is not a function</code></p></blockquote> <h2 id="deleting"><a href="#deleting" class="header-anchor">#</a> Deleting</h2> <p>Models have static <code>removeById()</code> function to remove documents matching the given id value.
See the <a href="/classes/model.html#static-removebyid">API</a> docs for more detail.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>User<span class="token punctuation">.</span><span class="token function">removeById</span><span class="token punctuation">(</span><span class="token string">'userId'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Models have static <code>removeMany()</code> function to remove all documents matching the given condition.
See the <a href="/classes/model.html#static-removemany">API</a> docs for more detail.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>User<span class="token punctuation">.</span><span class="token function">removeMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'%JohnDoe%'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>The response status will be <strong>SUCCESS</strong> as long as no error occurs, otherwise it will be <strong>FAILURE</strong>.</p></div> <h2 id="updating"><a href="#updating" class="header-anchor">#</a> Updating</h2> <p>Each <code>model</code> has its own <code>updateById</code> method for modifying documents in the database without returning them to your application.
See the <a href="/classes/model.html#static-updatebyid">API</a> docs for more detail.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>User<span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span><span class="token string">'userId'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> age<span class="token operator">:</span> <span class="token number">30</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// update document with id equal to 'userId' with age 30</span>
</code></pre></div><p>Models have static method <code>replaceById</code> which has the same behavior as <strong>updateById</strong>, except that the replaceById replaces the existing document with the given document.
See the <a href="/classes/model.html#static-replacebyid">API</a> docs for more detail.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>User<span class="token punctuation">.</span><span class="token function">replaceById</span><span class="token punctuation">(</span><span class="token string">'userId'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> age<span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'John'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>The replaceById method completely replaces the existing document as long as the new document complies with the schema rules.</p></div> <p>Models have static <code>updateMany</code> function to update all documents matching the given condition.
See the <a href="/classes/model.html#static-updatemany">API</a> docs for more detail.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>User<span class="token punctuation">.</span><span class="token function">updateMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'%JohnDoe%'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'John'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>The response status will be <strong>SUCCESS</strong> as long as no error occurs, otherwise it will be <strong>FAILURE</strong>.</p></div> <p>Models have static <code>findOneAndUpdate</code> function to finds a document that matches the conditions of the collection and updates it.
See the <a href="/classes/model.html#static-findoneandupdate">API</a> docs for more detail.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>User<span class="token punctuation">.</span><span class="token function">findOneAndUpdate</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'%John Doe%'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'John'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token keyword">new</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> upsert<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>By default the option <strong>new</strong> and <strong>upsert</strong> are <strong>false</strong></p> <p>If options.new is <strong>true</strong> return the document after update otherwise by default return the document before update.</p> <p>If options.upsert is <strong>true</strong> insert a document if the document does not exist.</p></div> <h2 id="handling-multilpe-models"><a href="#handling-multilpe-models" class="header-anchor">#</a> Handling Multilpe Models</h2> <p>When you create a new <code>Model</code> Ottoman will register it by name.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> User <span class="token operator">=</span> <span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> userSchema<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Ottoman under the hood will register in a dictionary object with a key set to model name</span>
<span class="token keyword">const</span> models <span class="token operator">=</span> <span class="token punctuation">{</span>
  User<span class="token operator">:</span> UserModel<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Duplicate Model's name will throw an exception notifying about the register model duplication.</p></div> <h3 id="getting-existing-models"><a href="#getting-existing-models" class="header-anchor">#</a> Getting Existing Models</h3> <p>You can retrieve a registered Model using the <code>getModel</code> function.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> getModel<span class="token punctuation">,</span> model <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'ottoman'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> User <span class="token operator">=</span> <span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> string <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// anywhere else in the app</span>
<span class="token keyword">const</span> User <span class="token operator">=</span> <span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>If the name provided doesn't match any registered model <code>undefined</code> value will be returned.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Maybe you want to get an existing model and if it's don't exist then attempt to create, the next example could be helpful.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> getModel<span class="token punctuation">,</span> model <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'ottoman'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> User <span class="token operator">=</span> <span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> userSchema<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <h3 id="drop-collection"><a href="#drop-collection" class="header-anchor">#</a> Drop Collection</h3> <p>Ottoman's <code>Models</code> provide a <code>dropCollection</code> static method to remove a collection.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token operator">...</span>
<span class="token keyword">const</span> User <span class="token operator">=</span> <span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> schema<span class="token punctuation">,</span> <span class="token punctuation">{</span>scopeName<span class="token operator">:</span> <span class="token string">'scopeA'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// dropCollection without parameter will drop it's own collection</span>
<span class="token comment">// This case User Collection in the scopeA will be removed</span>
User<span class="token punctuation">.</span><span class="token function">dropCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// dropCollection with collectionName parameter will drop the collection in the same scope</span>
<span class="token comment">// This case Cat Collection in the scopeA will be removed</span>
User<span class="token punctuation">.</span><span class="token function">dropCollection</span><span class="token punctuation">(</span><span class="token string">'Cat'</span><span class="token punctuation">)</span>

<span class="token comment">// dropCollection can even drop a collection from another scope, if it's provide explicitly</span>
<span class="token comment">// This case Cat Collection in the scopeB will be removed</span>
User<span class="token punctuation">.</span><span class="token function">dropCollection</span><span class="token punctuation">(</span><span class="token string">'Cat'</span><span class="token punctuation">,</span> <span class="token string">'scopeB'</span><span class="token punctuation">)</span>
</code></pre></div><p>To check the dropCollection API click <a href="/classes/model.html#static-dropcollection">here</a></p> <h2 id="next-up"><a href="#next-up" class="header-anchor">#</a> Next Up</h2> <p>Now that we've covered <code>Models</code>, let's take a look at <a href="/guides/document">Documents</a>.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.765cd436.js" defer></script><script src="/assets/js/2.8041a87f.js" defer></script><script src="/assets/js/65.2d7758b2.js" defer></script>
  </body>
</html>
